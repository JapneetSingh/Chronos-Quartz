# Chronos&Quartz:
####An Image based watch recommender

### Motivation
#### How often do we come across cases when we get a brief glimpse of something in passing that we really love but don't have enough time to get information about it;  a dress, shoes or perhaps accessories that someone is wearing. We perhaps have just abut enough time to take an image

### Overview

An overview of your project.
What is the goal of your project?
The goal of my project was to use a picture to find similar men's wrist watches on amazon.
What are your results?
How can I see what you did? (Link to your live app!)

### The Process

* __Web Scraping:__<br />
  I started out by scraping over 5000 images and associated metadata from amazon using BeautifulSoup and urllib.
  The images were stored locally while the metadata was stored in MongoDB

* __Image Featurization and PCA:__<br />
 I used OpenCV 3.0 in python for my featurization. After multiple experiments with different techniques I decided to use Edge detection, Thresholding and color histograms to create my feature space. I had around 121,000 total features by the end of the process. The features from colors(around 1500) were dwarfed by the total features from other two techniques which focus more on the shape
 and design of the watch. I captured 90 % variance for the feature space with 3625 features.

* __Metadata Featurization:__<br />
  Metadata constituted of product descriptions and product information table found on each product page. Numerical and categorical variables were handled separately. Multiple categorical variables had more than 100 unique values. They were combined to create 1 giant string and TFIDF was performed. The numerical variables were all in different units and were handles by a module Pint.  


* __Modeling and Evaluation:__<br />
  I treated this as a similarity problem and tried multiple difference units. I get my best results with *Cosine* metric for Image features and *Jaccard index* for text

  Metadata model was used to supplement the result of the Image model. Any prediction that is made by both the models is shown first.  
  This is because metadata model picks based on only words. Since its an image based unsupervised learning problem no machine can match humans in evaluating the final results. Which is why I leave the decision in the users hands. The results seems to be doing a good job of detecting similar watches.

* __Future Work:__<br />
  Here are some other concepts and ideas I would like to use to add robustness to my model:<br />
    1) KeyPoint Detection and Contouring<br />
    2) Structural Similarity (SSIM) Index<br />
    3) Neural Networks<br />

### Code and Reproducing Results
You will need to install OpenCV to your system. The following link should help
http://stackoverflow.com/a/27650299

#### Scraping
The scraping code is in Image_Scraping.ipynb. Running the file once will download around 5000 images in the current working directory
This process may take about an hour to two depending upon various factors.

#### Image model
Code for the image model constitutes the 3 files: <br />
          * *Features.py*: Takes a single image and derives it features<br />
          * *Image_processing.py*: creates a NumPy array from all the images by calling features.py for each image<br />
          * *Model.py*: Takes the array generated by Image_processing.py and uses it to fit the model and then present the results<br />

Just run Model.py from your computer. This will take care of  creating your dataset and training your model.It will also download pickled version of a number of important objects in your working directory. The process may take some time (~20 minutes) depending on your machine.

#### Metadata Model

Metadata model can be created by running through the iPython notebook *Metadata_Model.ipynb*. Again this will create a pickle file for the desired models.


### Tools and Packages used

* BeautifulSoup and urllib for Webscraping
* MongoDB, OS, JSON and PyMongo for storing scraped data
* OpenCV, NumPy, SciPy, NLTK, matplotlib and  Pint for EDA and featurization
* scikit-learn for Modeling
* AWS: S3 and EC2

### References
1) pyimagesearch.com <br />
2) https://github.com/JapneetSingh/dimensionality-reduction <br />
3) https://github.com/nateberman/Python-WebImageScraper<br />
4) http://goo.gl/EoAAFU<br />


###High level description of the project: what question or problem are you addressing?

The idea is use image featurization to recommend cheap wrist watches based on luxury watches that a user wants but cant afford
A web app would be used where user will enter an image of his choice and would get recommendations for similar looking watches
